<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.7.1 -->
<title>And now for something completely different | DavidS’ log</title>
<meta name="generator" content="Jekyll v4.2.0" />
<meta property="og:title" content="And now for something completely different" />
<meta name="author" content="David Schmitt" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="And now for something completely different. For a private project, I’m trying out ruby on rails. Here’s a link and brain dump of stuff I did." />
<meta property="og:description" content="And now for something completely different. For a private project, I’m trying out ruby on rails. Here’s a link and brain dump of stuff I did." />
<link rel="canonical" href="https://club.black.co.at/log/posts/2014-07-26-and-now-for-something-completely-different/" />
<meta property="og:url" content="https://club.black.co.at/log/posts/2014-07-26-and-now-for-something-completely-different/" />
<meta property="og:site_name" content="DavidS’ log" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2014-07-26T00:00:00+00:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="And now for something completely different" />
<meta name="twitter:site" content="@dev_el_ops" />
<meta name="twitter:creator" content="@dev_el_ops" />
<script type="application/ld+json">
{"description":"And now for something completely different. For a private project, I’m trying out ruby on rails. Here’s a link and brain dump of stuff I did.","@type":"BlogPosting","headline":"And now for something completely different","dateModified":"2014-07-26T00:00:00+00:00","url":"https://club.black.co.at/log/posts/2014-07-26-and-now-for-something-completely-different/","datePublished":"2014-07-26T00:00:00+00:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://club.black.co.at/log/posts/2014-07-26-and-now-for-something-completely-different/"},"author":{"@type":"Person","name":"David Schmitt"},"@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/log/assets/main.css"><link type="application/atom+xml" rel="alternate" href="https://club.black.co.at/log/feed.xml" title="DavidS' log" /><script async defer data-domain="club.black.co.at" src="https://plausible.black.co.at/js/plausible.js"></script>
    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-155086367-1', 'auto');
	ga('send', 'pageview', { 'page': location.pathname + location.search + location.hash});
	ga('set', 'anonymizeIp', true);
    </script>
    <!-- End Google Analytics -->
    </head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/log/">DavidS&#39; log</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/log/cv/index.html">DavidS&#39; CV</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">And now for something completely different</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2014-07-26T00:00:00+00:00" itemprop="datePublished">Jul 26, 2014
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>And now for something completely different. For a private project, I’m trying
out ruby on rails. Here’s a link and brain dump of stuff I did.</p>

<p>Start on <a href="http://rubyonrails.org/download/">Get Ruby on Rails in no time</a>.
I’m working on my Debian jessie (testing) machine, where I already have
<a href="https://github.com/sstephenson/rbenv">rbenv</a> installed, so I just create a new
directory <code class="language-plaintext highlighter-rouge">rails</code>, which will contain my rails
<a href="https://github.com/jf/rbenv-gemset">gemset</a>.</p>

<p>Inside I can install rails and create a new application as directed. Of course,
the rails server does <em>not</em> start as advertised.
<a href="https://github.com/sstephenson/execjs">ExecJS</a> is pining for a JS runtime,
takes no prisoners and aborts everything with a stacktrace.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ sudo aptitude install nodejs
</code></pre></div></div>

<p>Thank you, <a href="http://www.debian.org/">Debian</a>!</p>

<p>The server works now, and the default main page loads explaining that it works.
Nice. I
<a href="https://github.com/DavidS/hrdb/commit/3cf490746ef914cc6b4e872dbe827f73de04e8e5">commit</a>
everything to a new <a href="https://github.com/DavidS/hrdb">git repo</a> to be able to
see what will happen with the project. Since the initial instructions on this
page show the right direction, but no detail, I follow the link to the <a href="http://guides.rubyonrails.org/">Rails
Guides</a> where I start with the <a href="http://guides.rubyonrails.org/getting_started.html">Getting Started
with Rails</a> tour. The first
sections can be skipped, as the server is already running. The interesting part
begins with actually creating the first controller with <code class="language-plaintext highlighter-rouge">rails generate controller</code>.
It automatically inserts a default route into the configuration.
<a href="https://github.com/DavidS/hrdb/commit/fbf2e4bceddc6d15cb16e7975995e0ca2d1b2e1e">Commit</a>.
Enabling it as the default route for <code class="language-plaintext highlighter-rouge">/</code> is explained next.
<a href="https://github.com/DavidS/hrdb/commit/2d766b4377d634b92a7695af6cc0afcc31e1385a">Commit</a>.
RoR is talking to me.</p>

<h1 id="resources">Resources</h1>

<p>Now the meat of the framework is revealed.
<a href="http://guides.rubyonrails.org/getting_started.html#getting-up-and-running">Resources</a>
are the
<a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a>-able
contents of the new app. I start with the ever popular “people” resource and
add a default resource route and an empty controller.
<a href="https://github.com/DavidS/hrdb/commit/f7b3c95e5d7913ac18ec290c8c40cd5c61f30a81">Commit</a>.</p>

<p>Browsing through the new files, I notice that rails has helpfully created empty
test harnesses for me. I configure the repo for
<a href="https://travis-ci.org/DavidS/hrdb">travis-ci</a>.
<a href="https://github.com/DavidS/hrdb/commit/98561c3620ef6e5aff53ab1f6d5b49697d512676">Commit</a>.
As there is only a single default test, the build passes with flying colors for
ruby 2.1 and ruby 1.9. <a href="http://jruby.org/">JRuby</a> chokes on the native sqlite
extension. As JRuby is not my primary target, I just disable it again. I will
need to have some coverage testing set up too.</p>

<h1 id="get-on-with-it"><a href="https://www.youtube.com/watch?v=dEtm_Q2LK9g">Get on with it!</a></h1>

<p>Following the guide, I create the first empty controller action.</p>

<blockquote>
  <p>Note: something in this project makes ruby use gem references in stack traces
instead of mile-long paths. Very nice.</p>
</blockquote>

<p>Time passes. Documentation is read. Code is written.</p>

<p>Nice, RoR seems to have learned some lessons: there is a built-in POST params
validator. No <code class="language-plaintext highlighter-rouge">global_vars</code> fiasco here. Instead it just doesn’t work. I spend
some time reading <a href="http://weblog.rubyonrails.org/2012/3/21/strong-parameters/">more on strong
parameters</a> which
uses slightly different method call (<code class="language-plaintext highlighter-rouge">required</code> instead of <code class="language-plaintext highlighter-rouge">require</code>). This
doesn’t work either. No stacktrace too. Hmm. Welcome to the real world.</p>

<p>The <a href="https://github.com/rails/strong_parameters">official documentation</a> uses
<code class="language-plaintext highlighter-rouge">require</code> consistently, so I go with that. Even copy and pasting the example
from the <a href="http://guides.rubyonrails.org/action_controller_overview.html#strong-parameters">Action Controller
overview</a>
(which coincidentally matches my model) doesn’t help. Still no proper
stacktrace or other hint. Except that there is a “Full Trace” link, right below
the error message on the rendered 500 error page. D’oh!. I dive into the
underlying source. Glossing over the
<code class="language-plaintext highlighter-rouge">active_model/forbidden_attributes_protection.rb</code> file, which actually throws
the error doesn’t help much.</p>

<p>Another look at the code and guide finally reveals the problem: the new
<code class="language-plaintext highlighter-rouge">person_params</code> method must be used to access the params. There is no magic to
inject that call into the execution. I’m a little disappointed but I can live
with that.
<a href="https://github.com/DavidS/hrdb/commit/26a24ef10d73893859c78b5ddde8045ef662e994">Commit</a>.</p>

<p>The next piece is loading the new record from the database and creating a view
for it.
<a href="https://github.com/DavidS/hrdb/commit/7af7d7012863017d87a061d7d579bc1d5cf6279c">Commit</a>.</p>

<p>The guide now covers some basic things like programmatic linking to actions and
paths, model validation, updating and deleting resources. I’m starting to gloss
over things as I’m running out of time for now. Doesn’t help.</p>

<p>Finally, I look into authentication/authorization solutions for rails. Built-in
is a single-user basic http authorization, which is not very helpful for my
use-case. The guide recommends
<a href="https://github.com/plataformatec/devise">Devise</a> or
<a href="https://github.com/binarylogic/authlogic">Authlogic</a>. Devise is a full blown
MVC engine while Authlogic has no successful build on travis since adding the
travis badge back in April. I’ve also looked at <a href="https://github.com/theforeman/foreman/blob/develop/app/controllers/concerns/foreman/controller/authentication.rb">The Foreman’s
Authentication</a>
stuff, but they have coded up a complete custom AAA framework. I’m still
undecided between going the manual route, implementing authorization in custom
code while delegating authorization to the container or using Authlogic, which
looks much more rails-like than Devise. This will need more experimentation.</p>

<p>Enough for today, <a href="https://www.youtube.com/watch?v=6vMO3XmNXe4">I know rails</a>!</p>

<p>TODO:</p>

<ul>
  <li>coverage tests</li>
  <li>code climate</li>
  <li>add license</li>
</ul>

  </div><a class="u-url" href="/log/posts/2014-07-26-and-now-for-something-completely-different/index.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/log/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">DavidS&#39; log</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">David Schmitt</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p></p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
